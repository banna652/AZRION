<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AZRION - Reset Password</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'navy': '#1a2342',
            'lavender': '#e6e6fa',
          }
        }
      }
    }
  </script>
  <style>
    .container {
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    }
    .input-field {
      transition: all 0.3s ease;
    }
    .input-field:focus {
      border-color: #1a2342;
      box-shadow: 0 0 0 2px rgba(26, 35, 66, 0.2);
    }
    .btn-hover {
      transition: all 0.3s ease;
    }
    .btn-hover:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(26, 35, 66, 0.2);
    }
    .link-hover {
      transition: all 0.3s ease;
    }
    .link-hover:hover {
      color: #1a2342;
      text-decoration: underline;
    }
    .error { color: red; font-size: 14px; }
    .circle {
      background-color: rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      position: absolute;
    }
    .password-strength {
      height: 4px;
      border-radius: 2px;
      transition: all 0.3s ease;
    }
  </style>
</head>
<body class="bg-gray-500 min-h-screen flex items-center justify-center p-4">
  <!-- Home Page Link -->
  <div class="fixed top-6 right-6 z-50">
    <a href="/" class="flex items-center justify-center w-12 h-12 bg-white rounded-full shadow-lg text-navy hover:shadow-xl transition-all hover:scale-110" title="Go to Home Page">
      <i class="fas fa-home text-xl"></i>
    </a>
  </div>

  <div class="container rounded-3xl overflow-hidden w-full max-w-4xl flex">
    <!-- Left Panel -->
    <div class="bg-navy w-2/5 p-8 text-white relative overflow-hidden">
      <!-- Decorative circles -->
      <div class="circle w-32 h-32 top-10 left-10 opacity-10"></div>
      <div class="circle w-48 h-48 bottom-20 right-[-20px] opacity-10"></div>
      <div class="circle w-16 h-16 top-40 right-20 opacity-10"></div>
      <div class="circle w-24 h-24 bottom-40 left-[-10px] opacity-10"></div>

      <div class="flex flex-col h-full justify-center items-center text-center relative z-10">
        <h1 class="text-4xl font-bold mb-6">New Password</h1>
        <p class="text-lg opacity-90 mb-8">Create a strong password for your account</p>
        <div class="mt-4">
          <i class="fas fa-lock text-6xl opacity-80"></i>
        </div>
      </div>
    </div>

    <!-- Right Panel -->
    <div class="bg-lavender w-3/5 p-8">
      <div class="max-w-md mx-auto py-8">
        <h2 class="text-2xl font-bold text-center text-navy mb-2">Reset Password</h2>
        <p class="text-center text-gray-600 mb-8">Enter your new password</p>

        <form method="post" id="resetForm">
          {% csrf_token %}
          <!-- New Password Field -->
          <div class="mb-6">
            <label for="new_password" class="block text-gray-700 font-medium mb-2">New Password</label>
            <div class="relative">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <i class="fas fa-lock text-gray-400"></i>
              </div>
              <input 
                type="password" 
                name="new_password" 
                id="new_password" 
                class="input-field w-full pl-10 pr-10 py-3 rounded-lg border border-gray-300 focus:outline-none" 
                placeholder="Enter new password"
                required
              >
              <div class="absolute inset-y-0 right-0 pr-3 flex items-center">
                <i class="fas fa-eye text-gray-400 cursor-pointer hover:text-gray-600" id="toggleNewPassword"></i>
              </div>
            </div>
            {% if errors.new_password %}
                <div class="error mt-1">{{ errors.new_password }}</div>
            {% endif %}
            <!-- Password Strength Indicator -->
            <div class="mt-2">
              <div class="password-strength bg-gray-200" id="passwordStrength"></div>
              <p class="text-xs text-gray-500 mt-1" id="strengthText">Password strength</p>
            </div>
          </div>

          <!-- Confirm Password Field -->
          <div class="mb-6">
            <label for="confirm_password" class="block text-gray-700 font-medium mb-2">Confirm Password</label>
            <div class="relative">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <i class="fas fa-lock text-gray-400"></i>
              </div>
              <input 
                type="password" 
                name="confirm_password" 
                id="confirm_password" 
                class="input-field w-full pl-10 pr-10 py-3 rounded-lg border border-gray-300 focus:outline-none" 
                placeholder="Confirm new password"
                required
              >
              <div class="absolute inset-y-0 right-0 pr-3 flex items-center">
                <i class="fas fa-eye text-gray-400 cursor-pointer hover:text-gray-600" id="toggleConfirmPassword"></i>
              </div>
            </div>
            {% if errors.confirm_password %}
                <div class="error mt-1">{{ errors.confirm_password }}</div>
            {% endif %}
            <div class="mt-1" id="passwordMatch"></div>
          </div>

          <!-- Password Requirements -->
          <div class="mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
            <h4 class="font-medium text-blue-800 mb-2">Password Requirements:</h4>
            <ul class="text-sm text-blue-700 space-y-1">
              <li id="length-req"><i class="fas fa-times text-red-500 mr-2"></i>At least 8 characters</li>
              <li id="special-req"><i class="fas fa-times text-red-500 mr-2"></i>At least one special character</li>
              <li id="match-req"><i class="fas fa-times text-red-500 mr-2"></i>Passwords match</li>
            </ul>
          </div>

          <!-- Reset Password Button -->
          <button 
            type="submit" 
            class="btn-hover w-full bg-navy text-white py-3 rounded-lg font-medium flex items-center justify-center mb-6"
            id="submitBtn"
            disabled>
            <i class="fas fa-save mr-2"></i> Reset Password
          </button>

          <!-- Back to Login Link -->
          <div class="text-center">
            <p class="text-gray-600">
              <a href="{% url 'login' %}" class="text-navy font-medium link-hover">Back to Login</a>
            </p>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const newPasswordInput = document.getElementById('new_password');
      const confirmPasswordInput = document.getElementById('confirm_password');
      const passwordStrength = document.getElementById('passwordStrength');
      const strengthText = document.getElementById('strengthText');
      const passwordMatch = document.getElementById('passwordMatch');
      const submitBtn = document.getElementById('submitBtn');
      
      const lengthReq = document.getElementById('length-req');
      const specialReq = document.getElementById('special-req');
      const matchReq = document.getElementById('match-req');

      // Toggle password visibility
      document.getElementById('toggleNewPassword').addEventListener('click', function() {
        const type = newPasswordInput.getAttribute('type') === 'password' ? 'text' : 'password';
        newPasswordInput.setAttribute('type', type);
        this.classList.toggle('fa-eye');
        this.classList.toggle('fa-eye-slash');
      });

      document.getElementById('toggleConfirmPassword').addEventListener('click', function() {
        const type = confirmPasswordInput.getAttribute('type') === 'password' ? 'text' : 'password';
        confirmPasswordInput.setAttribute('type', type);
        this.classList.toggle('fa-eye');
        this.classList.toggle('fa-eye-slash');
      });

      function updateRequirement(element, met) {
        const icon = element.querySelector('i');
        if (met) {
          icon.className = 'fas fa-check text-green-500 mr-2';
          element.classList.add('text-green-700');
          element.classList.remove('text-blue-700');
        } else {
          icon.className = 'fas fa-times text-red-500 mr-2';
          element.classList.add('text-blue-700');
          element.classList.remove('text-green-700');
        }
      }

      function checkPasswordStrength(password) {
        let strength = 0;
        let strengthLabel = '';
        let color = '';

        if (password.length >= 8) strength += 25;
        if (/[a-z]/.test(password)) strength += 25;
        if (/[A-Z]/.test(password)) strength += 25;
        if (/[^A-Za-z0-9]/.test(password)) strength += 25;

        if (strength < 50) {
          strengthLabel = 'Weak';
          color = 'bg-red-500';
        } else if (strength < 75) {
          strengthLabel = 'Medium';
          color = 'bg-yellow-500';
        } else {
          strengthLabel = 'Strong';
          color = 'bg-green-500';
        }

        passwordStrength.className = `password-strength ${color}`;
        passwordStrength.style.width = strength + '%';
        strengthText.textContent = strengthLabel;
      }

      function validateForm() {
        const password = newPasswordInput.value;
        const confirmPassword = confirmPasswordInput.value;
        
        // Check length requirement
        const lengthMet = password.length >= 8;
        updateRequirement(lengthReq, lengthMet);
        
        // Check special character requirement
        const specialMet = /[^A-Za-z0-9]/.test(password);
        updateRequirement(specialReq, specialMet);
        
        // Check password match
        const matchMet = password === confirmPassword && password.length > 0;
        updateRequirement(matchReq, matchMet);
        
        if (matchMet) {
          passwordMatch.innerHTML = '<i class="fas fa-check text-green-500 mr-1"></i><span class="text-green-600 text-sm">Passwords match</span>';
        } else if (confirmPassword.length > 0) {
          passwordMatch.innerHTML = '<i class="fas fa-times text-red-500 mr-1"></i><span class="text-red-600 text-sm">Passwords do not match</span>';
        } else {
          passwordMatch.innerHTML = '';
        }
        
        // Enable/disable submit button
        const allMet = lengthMet && specialMet && matchMet;
        submitBtn.disabled = !allMet;
        submitBtn.classList.toggle('opacity-50', !allMet);
        submitBtn.classList.toggle('cursor-not-allowed', !allMet);
      }

      newPasswordInput.addEventListener('input', function() {
        checkPasswordStrength(this.value);
        validateForm();
      });

      confirmPasswordInput.addEventListener('input', validateForm);
    });
  </script>
</body>
</html>