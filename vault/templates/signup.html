<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AZRION - SIGNUP</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'navy': '#1a2342',
            'lavender': '#e6e6fa',
            'primary': '#1a2342',
            'secondary': '#e6e6fa',
          }
        }
      }
    }
  </script>
  <style>
    .signup-container {
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    }
    .input-field {
      transition: all 0.3s ease;
    }
    .input-field:focus {
      border-color: #1a2342;
      box-shadow: 0 0 0 2px rgba(26, 35, 66, 0.2);
    }
    .btn-hover {
      transition: all 0.3s ease;
    }
    .btn-hover:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(26, 35, 66, 0.2);
    }
    .social-btn {
      transition: all 0.3s ease;
    }
    .social-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    .link-hover {
      transition: all 0.3s ease;
    }
    .link-hover:hover {
      color: #1a2342;
      text-decoration: underline;
    }
    .home-link {
      transition: all 0.3s ease;
    }
    .home-link:hover {
      transform: scale(1.1);
      color: #1a2342;
    }
    .circle {
      background-color: rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      position: absolute;
    }
    @media (max-width: 768px) {
      .signup-container {
        flex-direction: column;
      }
      .left-panel, .right-panel {
        width: 100%;
      }
      .left-panel {
        height: 200px;
      }
    }
  </style>
</head>
<body class="bg-gray-500 min-h-screen flex items-center justify-center p-4">
  <!-- Home Page Link -->
  <div class="fixed top-6 right-6 z-50">
    <a href="/" class="home-link flex items-center justify-center w-12 h-12 bg-white rounded-full shadow-lg text-navy hover:shadow-xl" title="Go to Home Page">
      <i class="fas fa-home text-xl"></i>
    </a>
  </div>

  <div class="signup-container rounded-3xl overflow-hidden w-full max-w-5xl flex">
    <div class="left-panel bg-navy w-2/5 p-8 text-white relative overflow-hidden">
      <div class="circle w-32 h-32 top-10 left-10 opacity-10"></div>
      <div class="circle w-48 h-48 bottom-20 right-[-20px] opacity-10"></div>
      <div class="circle w-16 h-16 top-40 right-20 opacity-10"></div>
      <div class="circle w-24 h-24 bottom-40 left-[-10px] opacity-10"></div>
      <div class="circle w-8 h-8 top-20 right-40 opacity-10"></div>
      
      <div class="flex flex-col h-full justify-center items-center text-center relative z-10">
        {% if referrer %}
          <h1 class="text-4xl font-bold mb-4">Welcome!</h1>
          <p class="text-lg opacity-90 mb-4">You've been invited by</p>
          <div class="bg-white bg-opacity-20 rounded-lg p-4 mb-6">
            <h3 class="text-xl font-semibold">{{ referrer.full_name }}</h3>
            <p class="text-sm opacity-80">Join AZRION and get special benefits!</p>
          </div>
        {% else %}
          <h1 class="text-5xl font-bold mb-6">Join Us</h1>
          <p class="text-lg opacity-90 mb-8">Create an account to get started</p>
        {% endif %}
        
        <div class="mt-4">
          <svg class="w-20 h-20 mx-auto opacity-80" fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"></path>
            <path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z" opacity="0.4"></path>
          </svg>
        </div>
      </div>
    </div>

    <div class="right-panel bg-lavender w-3/5 p-8">
      <div class="max-w-md mx-auto py-6">
        <h2 class="text-2xl font-bold text-center text-navy mb-1">SIGN UP</h2>
        <p class="text-center text-gray-600 mb-6">Create your account</p>

        {% if messages %}
        <div class="mb-4">
          {% for message in messages %}
            <div class="p-3 rounded-lg text-white {{ message.tags }} bg-red-500 mb-2">
              {{ message }}
            </div>
          {% endfor %}
        </div>
        {% endif %}

        <form method="POST">
          {% csrf_token %}
          
          <div class="mb-4">
            <label for="fullname" class="block text-gray-700 font-medium mb-2">Full Name</label>
            <div class="relative">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <i class="fas fa-user text-gray-400"></i>
              </div>
              <input type="text" id="fullname" name="fullname" value="{{ form_data.fullname|default:'' }}" 
                     class="input-field w-full pl-10 pr-3 py-3 rounded-lg border border-gray-300 focus:outline-none" 
                     placeholder="Enter your full name">
            </div>
            {% if errors.full_name %}<p class="text-red-500 text-sm mt-1">{{ errors.full_name }}</p>{% endif %}
          </div>

          <div class="mb-4">
            <label for="email" class="block text-gray-700 font-medium mb-2">Email Address</label>
            <div class="relative">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <i class="fas fa-envelope text-gray-400"></i>
              </div>
              <input type="email" id="email" name="email" value="{{ form_data.email|default:'' }}" 
                     class="input-field w-full pl-10 pr-3 py-3 rounded-lg border border-gray-300 focus:outline-none" 
                     placeholder="Enter your email">
            </div>
            {% if errors.email %}<p class="text-red-500 text-sm mt-1">{{ errors.email }}</p>{% endif %}
          </div>

          <div class="mb-4">
            <label for="ph_number" class="block text-gray-700 font-medium mb-2">Phone Number</label>
            <div class="relative flex">
              <span class="flex items-center px-3 rounded-l-lg border border-r-0 border-gray-300 bg-gray-100 text-gray-600">+91</span>
              <input type="text" id="ph_number" name="ph_number" value="{{ form_data.ph_number|default:'' }}" 
                     class="input-field w-full px-3 py-3 rounded-r-lg border border-gray-300 focus:outline-none" 
                     placeholder="Enter 10-digit mobile number">
            </div>
            {% if errors.ph_number %}<p class="text-red-500 text-sm mt-1">{{ errors.ph_number }}</p>{% endif %}
          </div>

          <div class="mb-4">
            <label for="password" class="block text-gray-700 font-medium mb-2">Password</label>
            <div class="relative">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <i class="fas fa-lock text-gray-400"></i>
              </div>
              <input type="password" id="password" name="password" 
                     class="input-field w-full pl-10 pr-10 py-3 rounded-lg border border-gray-300 focus:outline-none" 
                     placeholder="Create a password">
              <div class="absolute inset-y-0 right-0 pr-3 flex items-center">
                <i class="fas fa-eye text-gray-400 cursor-pointer hover:text-gray-600" id="togglePassword"></i>
              </div>
            </div>
            {% if errors.password %}<p class="text-red-500 text-sm mt-1">{{ errors.password }}</p>{% endif %}
          </div>

          <div class="mb-4">
            <label for="confirmPassword" class="block text-gray-700 font-medium mb-2">Confirm Password</label>
            <div class="relative">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <i class="fas fa-lock text-gray-400"></i>
              </div>
              <input type="password" id="confirmPassword" name="confirmPassword" 
                     class="input-field w-full pl-10 pr-10 py-3 rounded-lg border border-gray-300 focus:outline-none" 
                     placeholder="Confirm your password">
              <div class="absolute inset-y-0 right-0 pr-3 flex items-center">
                <i class="fas fa-eye text-gray-400 cursor-pointer hover:text-gray-600" id="toggleConfirmPassword"></i>
              </div>
            </div>
            {% if errors.confirm_password %}<p class="text-red-500 text-sm mt-1">{{ errors.confirm_password }}</p>{% endif %}
          </div>

          <!-- Referral Code Field -->
          <div class="mb-4">
            <label for="referral_code" class="block text-gray-700 font-medium mb-2">
              Referral Code (Optional)
              {% if referrer %}
                <span class="text-green-600 text-sm">- Auto-filled from invitation</span>
              {% endif %}
            </label>
            <div class="relative">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <i class="fas fa-gift text-gray-400"></i>
              </div>
              <input type="text" id="referral_code" name="referral_code" 
                     value="{{ form_data.referral_code|default:'' }}" 
                     class="input-field w-full pl-10 pr-3 py-3 rounded-lg border border-gray-300 focus:outline-none" 
                     placeholder="Enter referral code (if any)"
                     {% if referrer %}readonly{% endif %}>
            </div>
            {% if errors.referral_code %}<p class="text-red-500 text-sm mt-1">{{ errors.referral_code }}</p>{% endif %}
            {% if referrer %}
              <p class="text-green-600 text-xs mt-1">
                <i class="fas fa-info-circle"></i> You'll get special benefits for joining through this referral!
              </p>
            {% endif %}
          </div>

          <div class="flex items-center mb-6">
            <input type="checkbox" id="terms" name="terms" 
                   class="h-4 w-4 text-navy focus:ring-navy border-gray-300 rounded" 
                   {% if form_data.terms %}checked{% endif %}>
            <label for="terms" class="ml-2 block text-sm text-gray-700">
              I agree to the <a href="{% url 'terms' %}" class="text-navy link-hover">Terms of Service</a> 
              and <a href="{% url 'privacy' %}" class="text-navy link-hover">Privacy Policy</a>
            </label>
          </div>
          {% if errors.terms %}<p class="text-red-500 text-sm mb-5">{{ errors.terms }}</p>{% endif %}

          <button type="submit" class="btn-hover w-full bg-navy text-white py-3 rounded-lg font-medium flex items-center justify-center">
            <i class="fas fa-user-plus mr-2"></i> SIGN UP
          </button>

          <div class="mt-6">
            <p class="text-center text-gray-600 mb-4">or sign up with</p>
            <div class="flex">
              <a href="{% url 'social:begin' 'google-oauth2' %}" class="social-btn w-full bg-gray-300 border border-gray-300 py-3 rounded-lg flex items-center justify-center">
                <i class="fab fa-google text-gray-700 mr-2"></i> Google
              </a>
            </div>
          </div>

          <div class="mt-6 text-center">
            <p class="text-gray-600">
              Already have an account? 
              <a href="{% url 'login' %}" class="text-navy font-medium link-hover">Login here</a>
            </p>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script>
    document.getElementById('togglePassword').addEventListener('click', function() {
      const passwordInput = document.getElementById('password');
      const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
      passwordInput.setAttribute('type', type);
      this.classList.toggle('fa-eye');
      this.classList.toggle('fa-eye-slash');
    });

    document.getElementById('toggleConfirmPassword').addEventListener('click', function() {
      const confirmPasswordInput = document.getElementById('confirmPassword');
      const type = confirmPasswordInput.getAttribute('type') === 'password' ? 'text' : 'password';
      confirmPasswordInput.setAttribute('type', type);
      this.classList.toggle('fa-eye');
      this.classList.toggle('fa-eye-slash');
    });

    function handleResize() {
      const leftPanel = document.querySelector('.left-panel');
      const rightPanel = document.querySelector('.right-panel');
      if (window.innerWidth < 768) {
        leftPanel.classList.remove('w-2/5');
        rightPanel.classList.remove('w-3/5');
        leftPanel.classList.add('w-full');
        rightPanel.classList.add('w-full');
      } else {
        leftPanel.classList.add('w-2/5');
        rightPanel.classList.add('w-3/5');
        leftPanel.classList.remove('w-full');
        rightPanel.classList.remove('w-full');
      }
    }

    window.addEventListener('resize', handleResize);
    handleResize();

    // Referral code uppercase conversion
    document.getElementById('referral_code').addEventListener('input', function(e) {
      if (!this.readOnly) {
        this.value = this.value.toUpperCase();
      }
    });

    document.addEventListener('DOMContentLoaded', () => {
      const fields = [
        {
          id: 'fullname',
          validate: (v) => /^[A-Za-z ]+$/.test(v),
          error: 'Name must contain only letters and spaces.'
        },
        {
          id: 'email',
          validate: (v) => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v),
          error: 'Please enter a valid email address.'
        },
        {
          id: 'ph_number',
          validate: (v) => /^\d{10}$/.test(v),
          error: 'Enter a valid 10-digit phone number.'
        },
        {
          id: 'password',
          validate: (v) => /^(?=.*[!@#$%^&*])[A-Za-z\d!@#$%^&*]{8,}$/.test(v),
          error: 'Password must be at least 8 characters and include a special character.'
        },
        {
          id: 'confirmPassword',
          validate: (v) => v === document.getElementById('password').value,
          error: 'Passwords do not match.'
        }
      ];

      const form = document.querySelector('form');
      fields.forEach((field, idx) => {
        const input = document.getElementById(field.id);
        input.addEventListener('keydown', (e) => {
          if (e.key === 'Enter') {
            e.preventDefault();
            const value = input.value.trim();
            const errorId = `${field.id}_error`;
            let errorElem = document.getElementById(errorId);
            
            if (!errorElem) {
              errorElem = document.createElement('p');
              errorElem.id = errorId;
              errorElem.className = 'text-red-500 text-sm mt-1';
              input.closest('div.mb-4').appendChild(errorElem);
            }
            
            if (!field.validate(value)) {
              errorElem.textContent = field.error;
              input.focus();
            } else {
              errorElem.textContent = '';
              if (idx + 1 === fields.length) {
                const terms = document.getElementById('terms');
                let termsError = document.getElementById('terms_error');
                if (!terms.checked) {
                  if (!termsError) {
                    termsError = document.createElement('p');
                    termsError.id = 'terms_error';
                    termsError.className = 'text-red-500 text-sm mb-5';
                    terms.closest('div').after(termsError);
                  }
                  termsError.textContent = 'Please agree to the Terms and Privacy Policy.';
                  terms.focus();
                } else {
                  if (termsError) termsError.textContent = '';
                  form.submit();
                }
              } else {
                document.getElementById(fields[idx + 1].id).focus();
              }
            }
          }
        });
      });
    });
  </script>
</body>
</html>
